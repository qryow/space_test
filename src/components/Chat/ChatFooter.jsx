import React, { useEffect, useState } from 'react';
import style from './styles/ChatStyles.module.css'
import { useDispatch } from 'react-redux';
import { sendMessage } from '../../store/chat/chatSlice';

const ChatFooter = ({currentRoom,oneRoomRer}) => {
const [text, setText] = useState('')
const [roomId, setRoomId] = useState()
  const dispatch = useDispatch();
  const chatroom = currentRoom


  
   useEffect(() => {
      if (currentRoom) {
        setRoomId(currentRoom.id);
      }
    }, [currentRoom]);
console.log(roomId);

const sendMsg = async () => {
   if (roomId) {
      await dispatch(
      sendMessage({
         chatroom: roomId,
         text,
      }),
      oneRoomRer()
   );
   }
};
   
   return (
      <div className={style.chat__footer}>
         <div className={style.type__field}>
            <input className={style.footer__input} value={text}
             onChange={e => setText(e.target.value)} placeholder='Type something...' type="text" />
            <i className={style.image__icon}>
               <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path d="M12.5 18.9582H7.50002C2.97502 18.9582 1.04169 17.0248 1.04169 12.4998V7.49984C1.04169 2.97484 2.97502 1.0415 7.50002 1.0415H12.5C17.025 1.0415 18.9584 2.97484 18.9584 7.49984V12.4998C18.9584 17.0248 17.025 18.9582 12.5 18.9582ZM7.50002 2.2915C3.65835 2.2915 2.29169 3.65817 2.29169 7.49984V12.4998C2.29169 16.3415 3.65835 17.7082 7.50002 17.7082H12.5C16.3417 17.7082 17.7084 16.3415 17.7084 12.4998V7.49984C17.7084 3.65817 16.3417 2.2915 12.5 2.2915H7.50002Z" fill="#BBBBBB"/>
                  <path d="M7.49998 8.95833C6.23331 8.95833 5.20831 7.93333 5.20831 6.66667C5.20831 5.4 6.23331 4.375 7.49998 4.375C8.76665 4.375 9.79165 5.4 9.79165 6.66667C9.79165 7.93333 8.76665 8.95833 7.49998 8.95833ZM7.49998 5.625C6.92498 5.625 6.45831 6.09167 6.45831 6.66667C6.45831 7.24167 6.92498 7.70833 7.49998 7.70833C8.07498 7.70833 8.54165 7.24167 8.54165 6.66667C8.54165 6.09167 8.07498 5.625 7.49998 5.625Z" fill="#BBBBBB"/>
                  <path d="M2.22497 16.4168C2.02497 16.4168 1.82497 16.3168 1.70831 16.1418C1.51664 15.8585 1.59164 15.4668 1.88331 15.2751L5.99164 12.5168C6.89164 11.9085 8.13331 11.9835 8.94997 12.6751L9.22497 12.9168C9.64164 13.2751 10.35 13.2751 10.7583 12.9168L14.225 9.9418C15.1083 9.18346 16.5 9.18346 17.3916 9.9418L18.75 11.1085C19.0083 11.3335 19.0416 11.7251 18.8166 11.9918C18.5916 12.2501 18.2 12.2835 17.9333 12.0585L16.575 10.8918C16.1583 10.5335 15.45 10.5335 15.0333 10.8918L11.5666 13.8668C10.6833 14.6251 9.29164 14.6251 8.39997 13.8668L8.12497 13.6251C7.74164 13.3001 7.10831 13.2668 6.68331 13.5585L2.57497 16.3168C2.46664 16.3835 2.34164 16.4168 2.22497 16.4168Z" fill="#BBBBBB"/>
               </svg>
               <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path d="M12.5 18.9582H7.50002C2.97502 18.9582 1.04169 17.0248 1.04169 12.4998V7.49984C1.04169 2.97484 2.97502 1.0415 7.50002 1.0415H11.6667C12.0084 1.0415 12.2917 1.32484 12.2917 1.6665C12.2917 2.00817 12.0084 2.2915 11.6667 2.2915H7.50002C3.65835 2.2915 2.29169 3.65817 2.29169 7.49984V12.4998C2.29169 16.3415 3.65835 17.7082 7.50002 17.7082H12.5C16.3417 17.7082 17.7084 16.3415 17.7084 12.4998V8.33317C17.7084 7.9915 17.9917 7.70817 18.3334 7.70817C18.675 7.70817 18.9584 7.9915 18.9584 8.33317V12.4998C18.9584 17.0248 17.025 18.9582 12.5 18.9582Z" fill="#BBBBBB"/>
                  <path d="M18.3334 8.95841H15C12.15 8.95841 11.0417 7.85007 11.0417 5.00007V1.66674C11.0417 1.41674 11.1917 1.18341 11.425 1.09174C11.6584 0.991739 11.925 1.05007 12.1084 1.22507L18.775 7.89174C18.95 8.06674 19.0084 8.34174 18.9084 8.57507C18.8084 8.8084 18.5834 8.95841 18.3334 8.95841ZM12.2917 3.17507V5.00007C12.2917 7.15007 12.85 7.70841 15 7.70841H16.825L12.2917 3.17507Z" fill="#BBBBBB"/>
               </svg>
               <svg xmlns="http://www.w3.org/2000/svg" width="2" height="18" viewBox="0 0 2 18" fill="none">
                  <path d="M1 0.5V17.5" stroke="#BBBBBB"/>
               </svg>
               <div onClick={sendMsg}>
                  <svg  xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                     <path d="M4.50831 18.125C3.57498 18.125 2.98331 17.8083 2.60831 17.4333C1.87498 16.7 1.35831 15.1416 3.00831 11.8333L3.73331 10.3916C3.82498 10.2 3.82498 9.79996 3.73331 9.60829L3.00831 8.16663C1.34998 4.85829 1.87498 3.29162 2.60831 2.56662C3.33331 1.83329 4.89998 1.30829 8.19998 2.96662L15.3333 6.53329C17.1083 7.41662 18.0833 8.64996 18.0833 9.99996C18.0833 11.35 17.1083 12.5833 15.3416 13.4666L8.20831 17.0333C6.59164 17.8416 5.39164 18.125 4.50831 18.125ZM4.50831 3.12496C4.05831 3.12496 3.70831 3.23329 3.49164 3.44996C2.88331 4.04996 3.12498 5.60829 4.12498 7.59996L4.84998 9.04996C5.11664 9.59162 5.11664 10.4083 4.84998 10.95L4.12498 12.3916C3.12498 14.3916 2.88331 15.9416 3.49164 16.5416C4.09164 17.15 5.64998 16.9083 7.64998 15.9083L14.7833 12.3416C16.0916 11.6916 16.8333 10.8333 16.8333 9.99162C16.8333 9.14996 16.0833 8.29162 14.775 7.64162L7.64164 4.08329C6.37498 3.44996 5.28331 3.12496 4.50831 3.12496Z" fill="#FF39A4"/>
                     <path d="M9.03333 10.625H4.53333C4.19166 10.625 3.90833 10.3417 3.90833 10C3.90833 9.65833 4.19166 9.375 4.53333 9.375H9.03333C9.37499 9.375 9.65833 9.65833 9.65833 10C9.65833 10.3417 9.37499 10.625 9.03333 10.625Z" fill="#FF39A4"/>
                  </svg>
               </div>
            </i>
         </div>
      </div>
   );
};

export default ChatFooter;